<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Elasticsearch安装教程</title>
    <url>/2020/01/19/Elasticsearch%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<font size = 2 color = red >
备注：全程使用cwq用户操作，因为elasticsearch不允许直接使用root启动
</font>
#单机版
1.下载地址
&emsp;官网：https://www.elastic.co/cn/downloads/elasticsearch
![Image text](../Es_img/01.png)
2.上传文件
&emsp;通过远程连接工具将文件上传到 /opt/software/目录下
3.解压
&emsp;将上传的tar包解压到opt/module/目录下
&emsp;tar-zxvf elasticsearch-6.3.1.tar.gz -C /opt/module/
4.修改配置
&emsp;修改elasticsearch-6.3.1/config/elasticsearch.yml文件中的host和port。
![Image text](../Es_img/02.png)
5.启动ES 
&emsp;进入解压后es的目录下然后执行启动命令
&emsp;[cwq@hadoop200 elasticsearch-6.3.1]# bin/elasticsearch
6.测试
&emsp;http://hadoop200:9200
![Image text](../Es_img/03.png)

<p>#集群版<br>步骤 1: 下载安装包<br>&emsp;官网：<a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a><br>步骤 2: 解压<br>&emsp;tar -zxvf elasticsearch-6.3.1.tar.gz -C /opt/module<br>步骤 3: 修改配置文件config/elasticsearch.yml</p>
<pre>
\#---------------------------------- Cluster ----------------------------------
\# 设置集群名称
cluster.name: myES
\# ------------------------------------ Node ------------------------------------
\# 当前节点名称，各个节点是不一样的
node.name: node-200
\# ----------------------------------- Memory -----------------------------------
\# 关闭bootstrap的自检程序
bootstrap.memory_lock: false
bootstrap.system_call_filter: false
\# ---------------------------------- Network -----------------------------------
\# 给当前节点绑定 ip 地址
network.host: hadoop200
\# 端口号保持默认 9200
\#http.port: 9200
\# --------------------------------- Discovery ----------------------------------
\# 集群个节点IP地址，也可以使用域名，需要各节点能够解析
discovery.zen.ping.unicast.hosts: ["hadoop200", "hadoop201", "hadoop202"]
</pre>
<p>步骤 4: 分发 ElasticSearch<br>&emsp;注意修改每个节点的名<br><img src="../Es_img/04.png" alt="Image text"><br>步骤 5 启动 ElasticSearch<br>&emsp;分别在 3 台设备上启动 ElasticSearch<br>&emsp;bin/elasticsearch &amp;<br>步骤 6 查看 ElasticSearch 是否启动成功<br><img src="../Es_img/05.png" alt="Image text"><br>步骤 7 测试是否可以连接到 ElasticSearch<br>&emsp;curl <a href="http://hadoop200:9200/_cat/nodes?v" target="_blank" rel="noopener">http://hadoop200:9200/_cat/nodes?v</a><br><img src="../Es_img/06.png" alt="Image text"><br>&emsp;或者在浏览器中输入地址: <a href="http://hadoop200:9200/_cat/nodes?v" target="_blank" rel="noopener">http://hadoop200:9200/_cat/nodes?v</a><br>#问题及解决方案<br>默认 elasticsearch 是单机访问模式，就是只能自己访问自己。 但是我们之后一定会设置成允许应用服务器通过网络方式访问。这时，elasticsearch 就会因为嫌弃单机版的低端默认配置而报错，甚至无法启动。 所以我们在这里就要把服务器的一些限制打开，能支持更多并发。<br>注意: 修改以下配置的时候需要切换到 root 用户, 每个节点都要修改.<br><strong>问题1：</strong>max file descriptors [4096] for elasticsearch process likely too low, increase to at least [65536] elasticsearch<br>原因：系统允许 Elasticsearch 打开的最大文件数需要修改成 65536<br>解决：<br>&emsp;vim /etc/security/limits.conf 添加内容：<br>&emsp;* soft nofile 65536<br>&emsp;* hard nofile 131072<br>&emsp;* soft nproc 2048<br>&emsp;* hard nproc 65536<br><strong>注意：“*” 不要省略掉</strong><br><strong>问题2：</strong>max number of threads [1024] for user [judy2] likely too low, increase to at least [2048] （CentOS7.x 不用改）<br>原因：允许最大进程数修该成4096<br>解决：<br>&emsp;vim /etc/security/limits.d/90-nproc.conf<br>&emsp;修改如下内容： * soft nproc 1024<br>&emsp;修改为* soft nproc 4096<br><strong>问题3：</strong>max virtual memory areas vm.max_map_count [65530] likely too low, increase to at least [262144] （CentOS7.x 不用改）<br>原因：一个进程可以拥有的虚拟内存区域的数量。<br>解决： 在 /etc/sysctl.conf 文件最后添加一行<br>&emsp;vm.max_map_count=262144</p>
]]></content>
      <categories>
        <category>Elasticsearch</category>
      </categories>
  </entry>
</search>
